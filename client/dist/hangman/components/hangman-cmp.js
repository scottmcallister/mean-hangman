"use strict";var __decorate=this&&this.__decorate||function(e,t,s,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(o=(a<3?n(o):a>3?n(t,s,o):n(t,s))||o);return a>3&&o&&Object.defineProperty(t,s,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core");require("rxjs/Rx");var phrase_service_1=require("../services/phrase-service"),body_cmp_1=require("./body-cmp"),phrase_cmp_1=require("./phrase-cmp"),wrong_guess_cmp_1=require("./wrong-guess-cmp"),HangmanCmp=function(){function e(e){this._phraseService=e,this.gameStatus="playing",this.lettersInPhrase=[],this.splitPhrase=[],this.numberWrong=0,this.numberRight=0,this.correctGuesses=[],this.wrongGuesses=[],this.getPhrase()}return e.prototype.onKey=function(e){if(this.isLetter(e)&&"playing"==this.gameStatus){var t=String.fromCharCode(e).toLowerCase();this.checkMatch(t),this.checkGameStatus()}},e.prototype.isLetter=function(e){return e>=65&&e<=90},e.prototype.checkMatch=function(e){e=e.toLowerCase(),this.lettersInPhrase.indexOf(e)>-1?this.correctGuesses.indexOf(e)<0&&(this.correctGuesses.push(e),this.numberRight++):this.wrongGuesses.indexOf(e)<0&&(this.wrongGuesses.push(e),this.numberWrong++)},e.prototype.reset=function(){this.getPhrase(),this.numberWrong=0,this.numberRight=0,this.correctGuesses=[],this.wrongGuesses=[],this.gameStatus="playing"},e.prototype.checkGameStatus=function(){6===this.numberWrong&&(this.gameStatus="lost"),this.numberRight===this.lettersInPhrase.length&&(this.gameStatus="won")},e.prototype.showModal=function(){if("playing"===this.gameStatus){this.gameStatus="guessing";var e=document.getElementById("guessModal");e.style.display="block";var t=document.getElementById("guess-input");t.focus()}},e.prototype.hideModal=function(e){var t=document.getElementById("guessModal"),s=document.getElementsByClassName("close");e.target!=t&&e.target!=s||(t.style.display="none",this.gameStatus="playing")},e.prototype.guessPhrase=function(e){e.preventDefault();var t=document.getElementById("guess-input").value;t.replace(/[^a-z0-9\s]/gi,"").toLowerCase()===this.phrase.replace(/[^a-z0-9\s]/gi,"").toLowerCase()?this.gameStatus="won":this.gameStatus="lost",document.getElementById("guessModal").style.display="none"},e.prototype.getPhrase=function(){var e=this;this._phraseService.getRandom().then(function(t){e.phrase=t,e.lettersInPhrase=t.replace(/[^a-z0-9]/gi,"").toLowerCase().split("").filter(function(e,t,s){return s.indexOf(e)===t});var s=t.split(" ");e.splitPhrase=[],s.forEach(function(t){e.splitPhrase.push(t.split(""))})},function(e){return console.log(e)})},e=__decorate([core_1.Component({selector:"hangman-cmp",templateUrl:"hangman/templates/hangman.html",styleUrls:["hangman/styles/hangman.css"],providers:[phrase_service_1.PhraseService],directives:[body_cmp_1.BodyComponent,phrase_cmp_1.PhraseComponent,wrong_guess_cmp_1.WrongGuessComponent],host:{"(window:keydown)":"onKey($event.keyCode)"}}),__metadata("design:paramtypes",[phrase_service_1.PhraseService])],e)}();exports.HangmanCmp=HangmanCmp;